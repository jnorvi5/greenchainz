(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{1060:(e,s,t)=>{Promise.resolve().then(t.bind(t,5782))},1705:(e,s,t)=>{"use strict";t.d(s,{A:()=>d,AuthProvider:()=>n});var r=t(5155),a=t(2115);let i=(0,t(5553).UU)("your_supabase_project_url_here","your_supabase_anon_key_here"),l=(0,a.createContext)(void 0);function n(e){let{children:s}=e,[t,n]=(0,a.useState)(null),[d,c]=(0,a.useState)(null),[o,p]=(0,a.useState)(!0);(0,a.useEffect)(()=>{i.auth.getSession().then(e=>{var s;let{data:{session:t}}=e;c(t),n(null!=(s=null==t?void 0:t.user)?s:null),p(!1)});let{data:{subscription:e}}=i.auth.onAuthStateChange((e,s)=>{var t;c(s),n(null!=(t=null==s?void 0:s.user)?t:null),p(!1)});return()=>e.unsubscribe()},[]);let x=async()=>{await i.auth.signOut()};return(0,r.jsx)(l.Provider,{value:{user:t,session:d,loading:o,signOut:x},children:s})}function d(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5782:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var r=t(5155),a=t(2115),i=t(5553),l=t(1705);let n=(0,i.UU)("your_supabase_project_url_here","your_supabase_anon_key_here");function d(){let{user:e}=(0,l.A)(),[s,t]=(0,a.useState)([]),[i,d]=(0,a.useState)({totalSuppliers:0,verifiedSuppliers:0,pendingApprovals:0,totalUsers:0}),[c,o]=(0,a.useState)(!0),[p,x]=(0,a.useState)("overview");(0,a.useEffect)(()=>{e&&(h(),u())},[e]);let h=async()=>{try{let{data:e,error:s}=await n.from("suppliers").select("*").order("created_at",{ascending:!1});if(s)throw s;t(e||[])}catch(e){console.error("Error fetching suppliers:",e)}},u=async()=>{try{let{data:e,error:s}=await n.from("suppliers").select("verified");if(s)throw s;let t=(null==e?void 0:e.length)||0,r=(null==e?void 0:e.filter(e=>e.verified).length)||0;d({totalSuppliers:t,verifiedSuppliers:r,pendingApprovals:t-r,totalUsers:1})}catch(e){console.error("Error fetching stats:",e)}finally{o(!1)}},m=async e=>{try{let{error:s}=await n.from("suppliers").update({verified:!0,verification_date:new Date().toISOString()}).eq("id",e);if(s)throw s;t(s=>s.map(s=>s.id===e?{...s,verified:!0,verification_date:new Date().toISOString()}:s)),d(e=>({...e,verifiedSuppliers:e.verifiedSuppliers+1,pendingApprovals:e.pendingApprovals-1})),alert("Supplier approved successfully!")}catch(e){console.error("Error approving supplier:",e),alert("Error approving supplier")}},g=async e=>{if(confirm("Are you sure you want to reject this supplier? This action cannot be undone."))try{let{error:s}=await n.from("suppliers").delete().eq("id",e);if(s)throw s;t(s=>s.filter(s=>s.id!==e)),d(e=>({...e,totalSuppliers:e.totalSuppliers-1,pendingApprovals:e.pendingApprovals-1})),alert("Supplier rejected and removed.")}catch(e){console.error("Error rejecting supplier:",e),alert("Error rejecting supplier")}};return e?c?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-700 mx-auto mb-4"}),(0,r.jsx)("p",{children:"Loading admin dashboard..."})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto p-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage suppliers, approvals, and platform content."})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)("nav",{className:"flex space-x-1",children:[{id:"overview",label:"Overview"},{id:"suppliers",label:"Supplier Management"},{id:"approvals",label:"Pending Approvals"}].map(e=>(0,r.jsx)("button",{onClick:()=>x(e.id),className:"px-4 py-2 rounded-lg font-medium ".concat(p===e.id?"bg-green-700 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:e.label},e.id))})}),"overview"===p&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Total Suppliers"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-green-600",children:i.totalSuppliers})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Verified Suppliers"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:i.verifiedSuppliers})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Pending Approvals"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-yellow-600",children:i.pendingApprovals})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Total Users"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-purple-600",children:i.totalUsers})]})]}),"suppliers"===p&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,r.jsx)("div",{className:"p-6 border-b",children:(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"All Suppliers"})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.location})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.category}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.sustainability_score>=90?"bg-green-100 text-green-800":e.sustainability_score>=80?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:e.sustainability_score})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.verified?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.verified?"Verified":"Pending"})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[(0,r.jsx)("a",{href:"/supplier/".concat(e.id),className:"text-blue-600 hover:text-blue-900",children:"View"}),!e.verified&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>m(e.id),className:"text-green-600 hover:text-green-900",children:"Approve"}),(0,r.jsx)("button",{onClick:()=>g(e.id),className:"text-red-600 hover:text-red-900",children:"Reject"})]})]})]},e.id))})]})})]}),"approvals"===p&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Pending Supplier Approvals"}),0===s.filter(e=>!e.verified).length?(0,r.jsx)("div",{className:"bg-white p-8 rounded-lg shadow text-center",children:(0,r.jsx)("p",{className:"text-gray-500",children:"No pending approvals at this time."})}):s.filter(e=>!e.verified).map(e=>(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:e.name}),(0,r.jsxs)("p",{className:"text-gray-600",children:[e.category," â€¢ ",e.location]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Sustainability Score: ",e.sustainability_score,"/100"]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>m(e.id),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Approve"}),(0,r.jsx)("button",{onClick:()=>g(e.id),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:"Reject"})]})]}),(0,r.jsx)("p",{className:"text-gray-700 mb-4",children:e.description}),e.certifications&&e.certifications.length>0&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("span",{className:"font-medium",children:"Certifications: "}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.certifications.map((e,s)=>(0,r.jsx)("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded text-xs",children:e},s))})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["Registered on ",new Date(e.created_at).toLocaleDateString()]})]},e.id))]})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Admin Access Required"}),(0,r.jsx)("p",{className:"mb-6 text-gray-600",children:"You must be signed in as an administrator to access this page."}),(0,r.jsx)("a",{href:"/auth",className:"bg-green-700 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors",children:"Sign In"})]})})}}},e=>{e.O(0,[553,441,255,358],()=>e(e.s=1060)),_N_E=e.O()}]);